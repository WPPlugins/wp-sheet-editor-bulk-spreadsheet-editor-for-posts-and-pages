function beAjaxLoop(e){var t={totalCalls:null,current:1,url:"",method:"GET",dataType:"json",data:{},prepareData:function(e,t){return e},onSuccess:function(e,t){},onError:function(e,t,n){},status:"running"},n=jQuery.extend(t,e);function a(){if(n.current<n.totalCalls+1){if("running"!==n.status)return!0;n.data.page=n.current;var e={url:n.url,dataType:n.dataType,data:n.prepareData(n.data,n),method:n.method};jQuery.ajax(e).done(function(e){n.onSuccess(e,n)&&(n.current++,setTimeout(function(){a()},1e3*parseInt(vgse_sheet_settings.wait_between_batches)))}).fail(function(e,t){n.onError(e,t,n)&&(n.current++,setTimeout(function(){a()},1e3*parseInt(vgse_sheet_settings.wait_between_batches)))})}}return a(),{pause:function(){n.status="paused"},resume:function(){n.status="running",a()}}}function loading_ajax(e){var t={estado:!0};jQuery.extend(t,e),1==t.estado?(jQuery("body").find(".sombra_popup").length||jQuery("body").append('<div class="sombra_popup be-ajax"><div class="sk-three-bounce"><div class="sk-child sk-bounce1"></div><div class="sk-child sk-bounce2"></div><div class="sk-child sk-bounce3"></div></div></div>'),jQuery(".sombra_popup").fadeIn(1e3)):jQuery(".sombra_popup").fadeOut(800,function(){})}function notification(e){var t={tipo:"success",mensaje:"",time:8600};jQuery.extend(t,e),setTimeout(function(){if("success"==t.tipo)e="green";else if("error"==t.tipo)e="red";else if("warning"==t.tipo)e="orange";else var e="blue";jQuery("#ohsnap").css("z-index","1100000"),setTimeout(function(){jQuery("#ohsnap").css("z-index","-1")},t.time),ohSnap(t.mensaje,{time:t.time,color:e})},500)}Object.defineProperty(Array.prototype,"chunk",{value:function(e){var t=this;return[].concat.apply([],t.map(function(n,a){return a%e?[]:[t.slice(a,a+e)]}))}}),jQuery(document).ajaxError(function(e,t,n,a){loading_ajax({estado:!1}),"abort"!==t.statusText&&notification(400==t.status?{mensaje:vgse_sheet_settings.texts.http_error_400,tipo:"error",tiempo:6e4}:403==t.status?{mensaje:vgse_sheet_settings.texts.http_error_403,tipo:"error",tiempo:6e4}:500==t.status||502==t.status||505==t.status?{mensaje:vgse_sheet_settings.texts.http_error_500_502_505,tipo:"error",tiempo:6e4}:503==t.status?{mensaje:vgse_sheet_settings.texts.http_error_503,tipo:"error",tiempo:6e4}:509==t.status?{mensaje:vgse_sheet_settings.texts.http_error_509,tipo:"error",tiempo:6e4}:504==t.status?{mensaje:vgse_sheet_settings.texts.http_error_504,tipo:"error",tiempo:6e4}:{mensaje:vgse_sheet_settings.texts.http_error_default,tipo:"error",tiempo:6e4})}),jQuery(document).ajaxComplete(function(e,t,n,a){"abort"!==t.statusText&&("0"===t.responseText||0===t.responseText||a)&&(loading_ajax({estado:!1}),notification({mensaje:vgse_sheet_settings.texts.http_error_500_502_505,tipo:"error",tiempo:6e4}))});function beLoadPosts(e,t,n,a){loading_ajax({estado:!0}),n||(n=!0),a||(a=!1),e.action="bep_load_data",jQuery("body").data("be-filters")&&(e.filters=jQuery("body").data("be-filters")),jQuery.ajax({url:ajaxurl,dataType:"json",type:"POST",data:e,dataType:"json"}).success(function(e){if("function"==typeof t&&(t(e),n))return!0;e.success?(vgAddRowsToSheet(e.data,null,a),notification({mensaje:vgse_sheet_settings.texts.posts_loaded}),loading_ajax({estado:!1}),jQuery(".ht_clone_top.handsontable").remove()):(loading_ajax({estado:!1}),notification({mensaje:e.data.message,tipo:"error",tiempo:6e4}))})}function beDeduplicateItems(e){var t=[],n=e[0]instanceof Array?"array":"object";return jQuery.each(e,function(e,a){var r="array"===n?a[0]:a.ID;"string"==typeof r&&(r=r.replace(/[^0-9]/gi,"")),t[r]||(t[r]=a)}),t}function beGetModifiedObjectProperties(e,t){var n={};return Object.keys(t).forEach(function(a){void 0!==e[a]&&t[a]==e[a]||(n[a]=t[a])}),n}function beArraysIdenticalCheck(e,t){if(e.length!==t.length)return!1;for(var n=e.length;n--;)if(e[n]!==t[n])return!1;return!0}function beGetModifiedItems(e,t){var e=beDeduplicateItems(e),t=beDeduplicateItems(t),n=[],a=e[0]instanceof Array?"array":"object";return e.forEach(function(r,o){if("array"!==a||void 0!==t[o]&&beArraysIdenticalCheck(e[o],t[o])){if("object"===a){var s,i=beGetModifiedObjectProperties(t[o],e[o]);void 0!==t[o]&&jQuery.isEmptyObject(i)||(t[o].post_type&&vgse_sheet_settings.saveFullRowPostTypes&&vgse_sheet_settings.saveFullRowPostTypes.indexOf(t[o].post_type)>-1?s=e[o]:(i.ID=o,s=i),jQuery.each(s,function(e,t){if("string"==typeof t&&t.indexOf("set_custom_images")>-1){var n=jQuery("<div/>").html(t).find(".set_custom_images").attr("data-images");s[e]=n||""}}),n.push(s))}}else n.push(r)}),n}function beGetTinymceContent(){if("none"!==jQuery(".wp-editor-area").css("display"))e=jQuery(".wp-editor-area").val()||"";else if(document.getElementById("editpost_ifr"))e=(document.getElementById("editpost_ifr").contentWindow.document||document.getElementById("editpost_ifr").contentDocument).body.innerHTML;else var e="";return e}function vgseExecuteFunctionByName(e,t){for(var n=[].slice.call(arguments).splice(2),a=e.split("."),r=a.pop(),o=0;o<a.length;o++)t=t[a[o]];return t[r].apply(t,n)}function vgObjectToArray(e){var t=[];for(var n in e)t.push(e[n]);return t}function _debounce(e,t,n){var a,r,o,s,i,u=function(){var c=_now()-s;c<t&&c>=0?a=setTimeout(u,t-c):(a=null,n||(i=e.apply(o,r),a||(o=r=null)))};return function(){o=this,r=arguments,s=_now();var c=n&&!a;return a||(a=setTimeout(u,t)),c&&(i=e.apply(o,r),o=r=null),i}}function _now(){return Date.now()||(new Date).getTime()}function _throttle(e,t,n){t||(t=300);var a,r,o,s=null,i=0;n||(n={});var u=function(){i=!1===n.leading?0:_now(),s=null,o=e.apply(a,r),s||(a=r=null)};return function(){var c=_now();i||!1!==n.leading||(i=c);var d=t-(c-i);return a=this,r=arguments,d<=0||d>t?(s&&(clearTimeout(s),s=null),i=c,o=e.apply(a,r),s||(a=r=null)):s||!1===n.trailing||(s=setTimeout(u,d)),o}}function vgseRemovePostFromSheet(e,t){var n=[];return e=parseInt(e),t.forEach(function(t,a){var r=jQuery.extend(!0,{},t);"string"==typeof r.ID&&(r.ID=parseInt(r.ID.replace(/[^0-9]/gi,""))),e!==r.ID&&n.push(t)}),n}function vgAddRowsToSheet(e,t,n){t||(t="append"),e||(e=[]),"prepend"===t&&(e=e.reverse());var a=hot.getSourceData();for(n&&e.forEach(function(e,t){var n=jQuery.extend(!0,{},e);"string"==typeof n.ID&&(n.ID=parseInt(n.ID.replace(/[^0-9]/gi,""))),a=vgseRemovePostFromSheet(n.ID,a)}),i=0;i<e.length;i++)"append"===t?a.push(jQuery.extend(!0,{},e[i])):a.unshift(jQuery.extend(!0,{},e[i]));hot.loadData(a),window.beOriginalData||(window.beOriginalData=[]),window.beOriginalData=jQuery.merge(window.beOriginalData,e)}function beSendImageIdToWP(e,t,n,a,r,o){setTimeout(function(){var t=hot.getDataAtCell(r.row,r.col),n=jQuery("<div/>").html(t);n.find(".set_custom_images").text(vgse_sheet_settings.texts.use_other_image),n.find(".set_custom_images").attr("data-images",e),n.find(".hidden").removeClass("hidden"),hot.setDataAtCell(r.row,r.col,n.html()),"function"==typeof o&&o(response)},800)}function vgseInitSelect2(){jQuery("select.select2").each(function(){var e={placeholder:jQuery(this).data("placeholder"),minimumInputLength:jQuery(this).data("min-input-length")||0};jQuery(this).data("remote")&&(e.ajax={url:ajaxurl,delay:1e3,data:function(e){return{search:e.term,page:e.page,action:jQuery(this).data("action"),output_format:jQuery(this).data("output-format"),post_type:jQuery(this).data("post-type")||jQuery("#post-data").data("post-type"),nonce:jQuery(this).data("nonce")}},processResults:function(e){return e.success?{results:e.data.data}:{results:[]}},cache:!0}),jQuery(this).select2(e)})}function vgseReloadSpreadsheet(){var e=jQuery(".remodal-bg").data("nonce"),t=jQuery("#post-data");window.beOriginalData=[],hot.loadData([]),beLoadPosts({post_type:t.data("post-type"),nonce:e})}