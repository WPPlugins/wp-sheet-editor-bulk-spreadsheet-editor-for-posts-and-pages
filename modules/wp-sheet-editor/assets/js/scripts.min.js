function beAjaxLoop(e){var t={totalCalls:null,current:1,url:"",method:"GET",dataType:"json",data:{},prepareData:function(e,t){return e},onSuccess:function(e,t){},onError:function(e,t,n){},status:"running"},n=jQuery.extend(t,e);function a(){if(n.current<n.totalCalls+1){if("running"!==n.status)return!0;n.data.page=n.current;var e={url:n.url,dataType:n.dataType,data:n.prepareData(n.data,n),method:n.method};jQuery.ajax(e).done(function(e){n.onSuccess(e,n)&&(n.current++,setTimeout(function(){a()},1e3*parseInt(vgse_sheet_settings.wait_between_batches)))}).fail(function(e,t){n.onError(e,t,n)&&(n.current++,setTimeout(function(){a()},1e3*parseInt(vgse_sheet_settings.wait_between_batches)))})}}return a(),{pause:function(){n.status="paused"},resume:function(){n.status="running",a()}}}function loading_ajax(e){var t={estado:!0};jQuery.extend(t,e),1==t.estado?(jQuery("body").find(".sombra_popup").length||jQuery("body").append('<div class="sombra_popup be-ajax"><div class="sk-three-bounce"><div class="sk-child sk-bounce1"></div><div class="sk-child sk-bounce2"></div><div class="sk-child sk-bounce3"></div></div></div>'),jQuery(".sombra_popup").fadeIn(1e3)):jQuery(".sombra_popup").fadeOut(800,function(){})}function notification(e){var t={tipo:"success",mensaje:"",time:8600};jQuery.extend(t,e),setTimeout(function(){if("success"==t.tipo)e="green";else if("error"==t.tipo)e="red";else if("warning"==t.tipo)e="orange";else var e="blue";jQuery("#ohsnap").css("z-index","1100000"),setTimeout(function(){jQuery("#ohsnap").css("z-index","-1")},t.time),ohSnap(t.mensaje,{time:t.time,color:e})},500)}Object.defineProperty(Array.prototype,"chunk",{value:function(e){var t=this;return[].concat.apply([],t.map(function(n,a){return a%e?[]:[t.slice(a,a+e)]}))}}),jQuery(document).ajaxError(function(e,t,n,a){loading_ajax({estado:!1}),"abort"!==t.statusText&&notification(400==t.status?{mensaje:vgse_sheet_settings.texts.http_error_400,tipo:"error",tiempo:6e4}:403==t.status?{mensaje:vgse_sheet_settings.texts.http_error_403,tipo:"error",tiempo:6e4}:500==t.status||502==t.status||505==t.status?{mensaje:vgse_sheet_settings.texts.http_error_500_502_505,tipo:"error",tiempo:6e4}:503==t.status?{mensaje:vgse_sheet_settings.texts.http_error_503,tipo:"error",tiempo:6e4}:509==t.status?{mensaje:vgse_sheet_settings.texts.http_error_509,tipo:"error",tiempo:6e4}:504==t.status?{mensaje:vgse_sheet_settings.texts.http_error_504,tipo:"error",tiempo:6e4}:{mensaje:vgse_sheet_settings.texts.http_error_default,tipo:"error",tiempo:6e4})}),jQuery(document).ajaxComplete(function(e,t,n,a){"abort"!==t.statusText&&("0"===t.responseText||0===t.responseText||a)&&(loading_ajax({estado:!1}),notification({mensaje:vgse_sheet_settings.texts.http_error_500_502_505,tipo:"error",tiempo:6e4}))});function beLoadPosts(e,t,n,a){loading_ajax({estado:!0}),n||(n=!0),a||(a=!1),e.action="bep_load_data",jQuery("body").data("be-filters")&&(e.filters=jQuery("body").data("be-filters")),jQuery.ajax({url:ajaxurl,dataType:"json",type:"POST",data:e,dataType:"json"}).success(function(e){if("function"==typeof t&&(t(e),n))return!0;e.success?(vgAddRowsToSheet(e.data,null,a),notification({mensaje:vgse_sheet_settings.texts.posts_loaded}),loading_ajax({estado:!1}),jQuery(".ht_clone_top.handsontable").remove()):(loading_ajax({estado:!1}),notification({mensaje:e.data.message,tipo:"error",tiempo:6e4}))})}function beDeduplicateItems(e){var t=[],n=e[0]instanceof Array?"array":"object";return jQuery.each(e,function(e,a){var r="array"===n?a[0]:a.ID;"string"==typeof r&&(r=r.replace(/[^0-9]/gi,"")),t[r]||(t[r]=a)}),t}function beGetModifiedObjectProperties(e,t){var n={};return Object.keys(t).forEach(function(a){void 0!==e[a]&&t[a]==e[a]||(n[a]=t[a])}),n}function beArraysIdenticalCheck(e,t){if(e.length!==t.length)return!1;for(var n=e.length;n--;)if(e[n]!==t[n])return!1;return!0}function beGetModifiedItems(e,t){var e=beDeduplicateItems(e),t=beDeduplicateItems(t),n=[],a=e[0]instanceof Array?"array":"object";return e.forEach(function(r,o){if("array"!==a||void 0!==t[o]&&beArraysIdenticalCheck(e[o],t[o])){if("object"===a){var s,i=beGetModifiedObjectProperties(t[o],e[o]);void 0!==t[o]&&jQuery.isEmptyObject(i)||(t[o].post_type&&vgse_sheet_settings.saveFullRowPostTypes&&vgse_sheet_settings.saveFullRowPostTypes.indexOf(t[o].post_type)>-1?s=e[o]:(i.ID=o,s=i),jQuery.each(s,function(e,t){if("string"==typeof t&&t.indexOf("set_custom_images")>-1){var n=jQuery("<div/>").html(t).find(".set_custom_images").attr("data-images");s[e]=n||""}}),n.push(s))}}else n.push(r)}),n}function beGetTinymceContent(){if("none"!==jQuery(".wp-editor-area").css("display"))e=jQuery(".wp-editor-area").val()||"";else if(document.getElementById("editpost_ifr"))e=(document.getElementById("editpost_ifr").contentWindow.document||document.getElementById("editpost_ifr").contentDocument).body.innerHTML;else var e="";return e}function vgseExecuteFunctionByName(e,t){for(var n=[].slice.call(arguments).splice(2),a=e.split("."),r=a.pop(),o=0;o<a.length;o++)t=t[a[o]];return t[r].apply(t,n)}function vgObjectToArray(e){var t=[];for(var n in e)t.push(e[n]);return t}function _debounce(e,t,n){var a,r,o,s,i,u=function(){var c=_now()-s;c<t&&c>=0?a=setTimeout(u,t-c):(a=null,n||(i=e.apply(o,r),a||(o=r=null)))};return function(){o=this,r=arguments,s=_now();var c=n&&!a;return a||(a=setTimeout(u,t)),c&&(i=e.apply(o,r),o=r=null),i}}function _now(){return Date.now()||(new Date).getTime()}function _throttle(e,t,n){t||(t=300);var a,r,o,s=null,i=0;n||(n={});var u=function(){i=!1===n.leading?0:_now(),s=null,o=e.apply(a,r),s||(a=r=null)};return function(){var c=_now();i||!1!==n.leading||(i=c);var d=t-(c-i);return a=this,r=arguments,d<=0||d>t?(s&&(clearTimeout(s),s=null),i=c,o=e.apply(a,r),s||(a=r=null)):s||!1===n.trailing||(s=setTimeout(u,d)),o}}function vgseRemovePostFromSheet(e,t){var n=[];return e=parseInt(e),t.forEach(function(t,a){var r=jQuery.extend(!0,{},t);"string"==typeof r.ID&&(r.ID=parseInt(r.ID.replace(/[^0-9]/gi,""))),e!==r.ID&&n.push(t)}),n}function vgAddRowsToSheet(e,t,n){t||(t="append"),e||(e=[]),"prepend"===t&&(e=e.reverse());var a=hot.getSourceData();for(n&&e.forEach(function(e,t){var n=jQuery.extend(!0,{},e);"string"==typeof n.ID&&(n.ID=parseInt(n.ID.replace(/[^0-9]/gi,""))),a=vgseRemovePostFromSheet(n.ID,a)}),i=0;i<e.length;i++)"append"===t?a.push(jQuery.extend(!0,{},e[i])):a.unshift(jQuery.extend(!0,{},e[i]));hot.loadData(a),window.beOriginalData||(window.beOriginalData=[]),window.beOriginalData=jQuery.merge(window.beOriginalData,e)}function beSendImageIdToWP(e,t,n,a,r,o){setTimeout(function(){var t=hot.getDataAtCell(r.row,r.col),n=jQuery("<div/>").html(t);n.find(".set_custom_images").text(vgse_sheet_settings.texts.use_other_image),n.find(".set_custom_images").attr("data-images",e),n.find(".hidden").removeClass("hidden"),hot.setDataAtCell(r.row,r.col,n.html()),"function"==typeof o&&o(response)},800)}function vgseInitSelect2(){jQuery("select.select2").each(function(){var e={placeholder:jQuery(this).data("placeholder"),minimumInputLength:jQuery(this).data("min-input-length")||0};jQuery(this).data("remote")&&(e.ajax={url:ajaxurl,delay:1e3,data:function(e){return{search:e.term,page:e.page,action:jQuery(this).data("action"),output_format:jQuery(this).data("output-format"),post_type:jQuery(this).data("post-type")||jQuery("#post-data").data("post-type"),nonce:jQuery(this).data("nonce")}},processResults:function(e){return e.success?{results:e.data.data}:{results:[]}},cache:!0}),jQuery(this).select2(e)})}function vgseReloadSpreadsheet(){var e=jQuery(".remodal-bg").data("nonce"),t=jQuery("#post-data");window.beOriginalData=[],hot.loadData([]),beLoadPosts({post_type:t.data("post-type"),nonce:e})}
jQuery(document).ready(function(e){if(!jQuery(".be-spreadsheet-wrapper").length)return!0;function t(){jQuery(window).scrollTop()>jQuery("#vg-header-toolbar-placeholder").offset().top?(jQuery("#vg-header-toolbar").css("top",""),jQuery("#vg-header-toolbar").addClass("sticky"),jQuery("#wpadminbar").hide(),jQuery("#vg-header-toolbar-placeholder").height(jQuery("#vg-header-toolbar").outerHeight())):(jQuery("#wpadminbar").show(),jQuery("#vg-header-toolbar").removeClass("sticky"),jQuery("#vg-header-toolbar-placeholder").height(0))}jQuery("#vg-header-toolbar").length&&(jQuery(window).scroll(_throttle(t,350)),t()),jQuery("#go-top").click(function(e){e.preventDefault(),jQuery("html, body").stop().animate({scrollTop:0},"300","swing",function(){})}),jQuery("body").append('<div id="ohsnap" style="z-index: -1"></div>');var a=jQuery("#vgse-wrapper");a.length&&a.find(":checkbox").labelauty(),jQuery("body").find(".tipso").tipso({size:"small",tooltipHover:!0,background:"#444444"});var o,n=jQuery("#post-data"),r=(jQuery("#responseConsole"),n.parent());jQuery("#formato").is(":checked")?format=!1:format=!0,setTimeout(function(){vgseInitSelect2()},2e3);var s={startRows:vgse_sheet_settings.startRows,startCols:vgse_sheet_settings.startCols,rowHeaders:!0,stretchH:"all",currentRowClassName:"currentRow",currentColClassName:"currentCol",fillHandle:!1,columnSorting:!0,contextMenu:["undo","redo"],autoWrapRow:!0,autoRowSize:!1,autoColumnSize:!1,viewportRowRenderingOffset:50,wordWrap:!0,colWidths:vgObjectToArray(vgse_sheet_settings.colWidths),colHeaders:vgObjectToArray(vgse_sheet_settings.colHeaders),columns:c(format),minSpareCols:0,minSpareRows:0,width:jQuery("body").hasClass("wp-admin")?null:n.width(),height:jQuery("body").hasClass("wp-admin")?null:jQuery(window).height(),debug:!0},i=vgse_sheet_settings.custom_handsontable_args?JSON.parse(vgse_sheet_settings.custom_handsontable_args):{},d=jQuery.extend(s,i);o=new Handsontable(n[0],d),window.hot=o,r.find("button[name=load]").trigger("click"),r.find("button[name=load]").click(function(){var e=jQuery(".remodal-bg").data("nonce");beLoadPosts({post_type:n.data("post-type"),nonce:e})}).click(),jQuery(".bulk-save.remodal").find(".remodal-cancel").click(function(e){jQuery('[data-remodal-id="bulk-save"]').remodal().close(),jQuery("body").scrollLeft(0)}),jQuery(".bulk-save.remodal .bulk-saving-screen").find(".remodal-cancel").click(function(e){jQuery("body").scrollLeft(0);var t=jQuery(this),a=t.parents(".remodal");a.find(".be-saving-warning").show(),a.find(".bulk-saving-screen").hide(),a.find("#be-nanobar-container").empty(),t.addClass("hidden"),a.find(".response").empty()}),jQuery(".bulk-save.remodal").find(".remodal-confirm").click(function(e){var t=jQuery(this).parents(".remodal");t.find(".be-saving-warning").show(),t.find(".bulk-saving-screen").hide(),t.find("#be-nanobar-container").empty(),t.find(".response").empty()}),jQuery("body").find(".be-start-saving").click(function(e){e.preventDefault();var t=jQuery(this).parents(".be-saving-warning"),a=t.next();a.find(".be-loading-anim").show(),t.fadeOut(),a.fadeIn();var r=jQuery(".remodal-bg").data("nonce"),s={classname:"be-progress-bar",id:"be-progress-bar",target:document.getElementById("be-nanobar-container")},i=new Nanobar(s),d=o.getSourceData();if(!(d=beGetModifiedItems(d,window.beOriginalData)).length)return jQuery(a).find(".response").append("<p>"+vgse_sheet_settings.texts.no_changes_to_save+"</p>"),loading_ajax({estado:!1}),a.find(".remodal-cancel").removeClass("hidden"),a.find(".be-loading-anim").hide(),setFormSubmitting(),!0;beAjaxLoop({totalCalls:Math.ceil(d.length/parseInt(vgse_sheet_settings.save_posts_per_page)),url:ajaxurl,dataType:"json",method:"POST",data:{data:[],post_type:n.data("post-type"),action:"bep_save_data",nonce:r,filters:jQuery("body").data("be-filters")?jQuery("body").data("be-filters"):""},prepareData:function(e,t){var a=d.chunk(parseInt(vgse_sheet_settings.save_posts_per_page));return e.data=a[t.current-1],e},onSuccess:function(e,t){if(!0===e.success||e.data||(e={data:{message:vgse_sheet_settings.texts.http_error_try_now},success:!1}),!e.success)return jQuery(a).find(".response").append("<p>"+e.data.message+"</p>"),confirm(e.data.message)?(t.current=0,jQuery(".bulk-saving-screen .response").scrollTop(jQuery(".bulk-saving-screen .response")[0].scrollHeight),!0):(jQuery(a).find(".response").append(vgse_sheet_settings.texts.saving_stop_error),jQuery(".bulk-saving-screen .response").scrollTop(jQuery(".bulk-saving-screen .response")[0].scrollHeight),!1);i.go(t.current/t.totalCalls*100);var n=parseInt(vgse_sheet_settings.save_posts_per_page)*t.current>d.length?d.length:parseInt(vgse_sheet_settings.save_posts_per_page)*t.current,r=(r=vgse_sheet_settings.texts.paged_batch_saved.replace("{updated}",n)).replace("{total}",d.length);return jQuery(a).find(".response").append("<p>"+r+"</p>"),t.current===t.totalCalls&&(jQuery(a).find(".response").append("<p>"+vgse_sheet_settings.texts.everything_saved+"</p>"),loading_ajax({estado:!1}),notification({mensaje:vgse_sheet_settings.texts.everything_saved}),a.find(".remodal-cancel").removeClass("hidden"),a.find(".be-loading-anim").hide(),setFormSubmitting(),window.beOriginalData=jQuery.extend(!0,{},o.getSourceData())),setTimeout(function(){jQuery(".bulk-saving-screen .response").scrollTop(jQuery(".bulk-saving-screen .response")[0].scrollHeight)},600),!0}})}),"undefined"!=typeof wp&&wp.media&&jQuery("body").delegate(".set_custom_images:not(.multiple)","click",function(e){e.preventDefault(),loading_ajax({estado:!0});var t=jQuery(this),a=t.parent("td"),n=o.getCoords(a[0]),r=jQuery("body").scrollLeft(),s=t.data("id"),i=t.data("key"),d=t.data("type"),l=[],u=jQuery(document).scrollTop(),c=jQuery("#infinito").prop("checked");return jQuery("#infinito").prop("checked",!1),media_uploader=wp.media({frame:"post",state:"insert",multiple:!1}),media_uploader.state("embed").on("select",function(){var e=media_uploader.state(),t=e.get("type"),a=e.props.toJSON();a.url=a.url||"","image"===t&&a.url&&beSendImageIdToWP(a.url,s,i,t,n)}),media_uploader.on("close",function(){jQuery("body").scrollLeft(r),jQuery(window).scrollTop(u),jQuery("#infinito").prop("checked",c)}),media_uploader.on("insert",function(){jQuery("body").scrollLeft(r);var e=media_uploader.state().get("selection").length,t=media_uploader.state().get("selection").models;if(!t.length)return!0;for(var a=0;a<e;a++)l.push(t[a].id);beSendImageIdToWP(l,s,i,d,n)}),media_uploader.open(),loading_ajax({estado:!1}),!1}),"undefined"!=typeof wp&&wp.media&&jQuery("body").delegate(".set_custom_images.multiple","click",function(e){e.preventDefault(),loading_ajax({estado:!0});var t=jQuery(this),a=t.parent("td"),n=o.getCoords(a[0]),r=jQuery("body").scrollLeft(),s=t.data("id"),i=t.data("key"),d=t.data("type"),l=[],u=jQuery(document).scrollTop(),c=jQuery("#infinito").prop("checked");return jQuery("#infinito").prop("checked",!1),media_uploader=wp.media({frame:"post",state:"insert",multiple:!0}),media_uploader.state("embed").on("select",function(){var e=media_uploader.state(),t=e.get("type"),a=e.props.toJSON();a.url=a.url||"","image"===t&&a.url&&beSendImageIdToWP(a.url,s,i,t,n)}),media_uploader.on("close",function(){jQuery("body").scrollLeft(r),jQuery(window).scrollTop(u),jQuery("#infinito").prop("checked",c)}),media_uploader.on("insert",function(){jQuery("body").scrollLeft(r);for(var e=media_uploader.state().get("selection").length,t=media_uploader.state().get("selection").models,a=0;a<e;a++)l.push(t[a].id);beSendImageIdToWP(l,s,i,d,n)}),media_uploader.open(),loading_ajax({estado:!1}),!1}),jQuery("body").delegate(".view_custom_images:not(.multiple)","click",function(){loading_ajax({estado:!0});var e=jQuery(this);post_id=e.data("id");var t=jQuery(".remodal-bg").data("nonce"),a=e.data("key"),o=e.data("type"),n=e.siblings(".set_custom_images").data("images");jQuery.ajax({type:"POST",url:ajaxurl,data:{id:post_id,action:"get_image_preview",nonce:t,key:a,type:o,localValue:n},dataType:"json",success:function(e){loading_ajax({estado:!1}),e.success?(jQuery("div[data-remodal-id=image] .modal-content").html(e.data.message),jQuery("[data-remodal-id=image]").remodal()):notification({mensaje:e.data.message,tipo:"error",tiempo:6e4})}})}),jQuery("body").delegate(".view_custom_images.multiple","click",function(){loading_ajax({estado:!0});var e=jQuery(this);post_id=e.data("id");var t=jQuery(".remodal-bg").data("nonce"),a=e.data("key"),o=e.data("type"),n=e.siblings(".set_custom_images").data("images");jQuery.ajax({type:"POST",url:ajaxurl,data:{id:post_id,action:"get_gallery_preview",nonce:t,key:a,type:o,localValue:n},dataType:"json",success:function(e){loading_ajax({estado:!1}),e.success?(jQuery("div[data-remodal-id=image] .modal-content").html(e.data.message),jQuery("[data-remodal-id=image]").remodal()):notification({mensaje:e.data.message,tipo:"error",tiempo:6e4})}})}),jQuery("button.siguiente").click(function(){var e=jQuery(this),t=e.data("pos"),a=e.parents(".remodal-wrapper").find(".remodal-confirm.guardar-popup-tinymce").data("key");jQuery(".btn-popup-content.button-tinymce-"+a).eq(t).trigger("click")}),jQuery("button.anterior").click(function(){var e=jQuery(this),t=e.data("pos"),a=e.parents(".remodal-wrapper").find(".remodal-confirm.guardar-popup-tinymce").data("key");jQuery(".btn-popup-content.button-tinymce-"+a).eq(t).trigger("click")}),jQuery("body").delegate(".btn-popup-content","click",function(){loading_ajax({estado:!0});var e=jQuery(this),t=e.data("id"),a=e.data("key"),o=e.data("type"),n=e.parents("tr").index(),r=e.parents("tbody").find("tr").length,s=jQuery(".remodal-bg").data("nonce");0===n?(jQuery("button.anterior").hide(),jQuery("button.anterior").next(".tipso").hide()):(jQuery("button.anterior").show(),jQuery("button.anterior").next(".tipso").show()),n===r-1?(jQuery("button.siguiente").hide(),jQuery("button.siguiente").next(".tipso").hide()):(jQuery("button.siguiente").show(),jQuery("button.siguiente").next(".tipso").show()),jQuery("button.anterior").data("pos",n-1),jQuery("button.siguiente").data("pos",n+1),jQuery.ajax({type:"POST",url:ajaxurl,data:{pid:t,action:"get_wp_post_single_data",nonce:s,key:"post_title",type:"post_data"},dataType:"json",success:function(e){e.success?jQuery(".modal-tinymce-editor .post-title-modal span").text(e.data.message).show():jQuery(".modal-tinymce-editor .post-title-modal").hide()}}),jQuery.ajax({type:"POST",url:ajaxurl,data:{pid:t,action:"get_wp_post_single_data",nonce:s,key:a,type:o},dataType:"json",success:function(e){e.success?("none"!==jQuery(".wp-editor-area").css("display")?(jQuery(".wp-editor-area").empty(),jQuery(".wp-editor-area").val(e.data.message)):document.getElementById("editpost_ifr")&&((document.getElementById("editpost_ifr").contentWindow.document||document.getElementById("editpost_ifr").contentDocument).body.innerHTML=e.data.message),window.originalTinyMCEData=beGetTinymceContent(),jQuery(".remodal2 .remodal-confirm").data("post_id",t),jQuery(".remodal2 .remodal-confirm").data("key",a),jQuery(".remodal2 .remodal-confirm").data("type",o),jQuery('[data-remodal-id="editor"]').remodal().open(),loading_ajax({estado:!1})):notification({mensaje:e.data.message,tipo:"error",tiempo:6e4})}})}),jQuery(".guardar-popup-tinymce").click(function(e){loading_ajax({estado:!0});var t=jQuery(".remodal2 .remodal-confirm");post_id=t.data("post_id"),key=t.data("key"),type=t.data("type");var a=beGetTinymceContent(),o=jQuery(".remodal-bg").data("nonce");!window.originalTinyMCEData||window.originalTinyMCEData&&a!==window.originalTinyMCEData?jQuery.ajax({type:"POST",url:ajaxurl,data:{post_id:post_id,content:a,action:"save_individual_post",nonce:o,key:key,type:type},dataType:"json",success:function(e){loading_ajax({estado:!1}),e.success?notification({mensaje:e.data.message}):notification({mensaje:e.data.message,tipo:"error",tiempo:6e4})}}):loading_ajax({estado:!1})}),r.find("button[name=mas]").click(function(){jQuery("#formato").is(":checked")?format=!0:format=!1;var e=jQuery(".remodal-bg").data("nonce");beLoadPosts({post_type:n.data("post-type"),paged:Math.ceil(o.countRows()/vgse_sheet_settings.posts_per_page)+1,nonce:e},function(e){e.success?(vgAddRowsToSheet(e.data),loading_ajax({estado:!1}),notification({mensaje:vgse_sheet_settings.texts.posts_loaded}),l=!0):(loading_ajax({estado:!1}),notification({mensaje:e.data.message,tipo:"error",tiempo:6e4}))})});jQuery("#post-data").offset();var l=!0,u=o.countRows();jQuery(window).on("scroll",_throttle(function(){jQuery("#infinito").is(":checked")&&u<vgse_sheet_settings.total_posts&&jQuery(window).scrollTop()+jQuery(window).height()==jQuery(document).height()&&!0===l&&scrollDown()&&(jQuery('button[name="mas"]').trigger("click"),l=!1)},500));function c(e){if(!0===e)t=vgse_sheet_settings.columnsFormat;else var t=vgse_sheet_settings.columnsUnformat;return t}jQuery("#formato").click(function(){jQuery(this).is(":checked")?format=!1:format=!0;var e=c(format);"function"==typeof vgseColumnsVisibilityUpdateHOT?vgseColumnsVisibilityUpdateHOT(e,vgObjectToArray(vgse_sheet_settings.colHeaders),vgObjectToArray(vgse_sheet_settings.colWidth),"softUpdate"):o.updateSettings({columns:c(format)})}),setInterval(function(){var e=o.countRows();jQuery('input[name="visibles"]').val(e)},1e3),jQuery("#addrow").click(function(){var e=jQuery(".remodal-bg").data("nonce"),t=jQuery("#post_type_new_row").val(),a=jQuery(this).next(".number_rows").length&&jQuery(this).next(".number_rows").val()?parseInt(jQuery(this).next(".number_rows").val()):1;loading_ajax({estado:!0}),jQuery.ajax({type:"POST",url:ajaxurl,data:{action:"insert_individual_post",nonce:e,post_type:t,rows:a},dataType:"json",success:function(e){e.success?(vgAddRowsToSheet(e.data.message,"prepend"),loading_ajax({estado:!1}),notification({mensaje:vgse_sheet_settings.texts.new_rows_added}),jQuery(window).scrollTop(jQuery(".be-spreadsheet-wrapper").offset().top-jQuery("#vg-header-toolbar").height()-20)):(loading_ajax({estado:!1}),notification({mensaje:e.data.message,tipo:"error",tiempo:6e4}))}})}),jQuery("#addrow2").click(function(){jQuery("#addrow").trigger("click")})});var lastScrollTop=0;function scrollDown(){var e=jQuery(window).scrollTop();return down=e>lastScrollTop,lastScrollTop=e,down}var formSubmitting=!1,setFormSubmitting=function(){formSubmitting=!0};jQuery(window).on("beforeunload",function(){if(!formSubmitting&&jQuery(".be-spreadsheet-wrapper").length)return vgse_sheet_settings.texts.save_changes_on_leave}),jQuery(document).ready(function(){var e=jQuery(".quick-setup-page-content");if(!e.length)return!0;e.find(".save-all-trigger").click(function(t){t.preventDefault();var a=jQuery(this);loading_ajax({estado:!0});var o=e.find(".save-trigger").first().parents("form");jQuery.post(o.attr("action"),{action:"vg_disable_quick_setup",nonce:o.find('[name="nonce"]').val()},function(e){a.data("saved","yes")}),e.find(".save-trigger").each(function(){jQuery(this).trigger("click")});var n=e.find(".save-trigger,.save-all-trigger").length,r=setInterval(function(){e.find(".save-trigger,.save-all-trigger").filter(function(){return"yes"===jQuery(this).data("saved")}).length===n&&(clearInterval(r),window.location.reload())},800)}),e.find(".save-trigger").click(function(e){e.preventDefault();var t=jQuery(this),a=t.parents("form");jQuery.post(a.attr("action"),a.serializeArray(),function(e){t.data("saved","yes")})})}),jQuery(document).ready(function(){jQuery("body").on("click",".form-submit-outside",function(e){e.preventDefault(),jQuery(this).parents(".remodal").find("form").submit()}),jQuery(document).on("opened",".remodal",function(){var e=jQuery(document).scrollTop(),t=jQuery("#infinito").prop("checked");jQuery("#infinito").prop("checked",!1),jQuery("body").data("temp-status",t).data("temp-scrolltop",e);var a=jQuery("body").scrollLeft();jQuery("body").data("temp-scrollleft",a)}),jQuery(document).on("closed",".remodal",function(){var e=jQuery("body").data("temp-scrolltop"),t=jQuery("body").data("temp-scrollleft"),a=jQuery("body").data("temp-status");e&&jQuery(window).scrollTop(e),t&&jQuery("body").scrollLeft(t),a&&jQuery("#infinito").prop("checked",a)})}),jQuery(document).ready(function(){jQuery("body").on("click",".button-handsontable",function(e){e.preventDefault();var t=jQuery(this),a=t.data(),o={button:t,modalSettings:a.modalSettings,existing:a.existing};window.vgseWCAttsCurrent=o;jQuery(".modal-handsontable").remodal().open()}),jQuery("body").on("click",".modal-handsontable .save-changes-handsontable",function(e){jQuery(this);var t=jQuery(".remodal-bg").data("nonce"),a=window.vgseWCAttsCurrent;loading_ajax({estado:!0});var o=hotAttr.getSourceData();a.modalSettings.modal_get_action||a.button.data("existing",o),jQuery.post(ajaxurl,{action:a.modalSettings.modal_save_action,nonce:t,postId:a.modalSettings.post_id,postType:a.modalSettings.post_type,data:o},function(e){loading_ajax({estado:!1}),jQuery(".modal-handsontable").remodal().close()})}),jQuery(document).on("opened",".modal-handsontable",function(){var t=window.vgseWCAttsCurrent;if(loading_ajax({estado:!0}),!t)return!0;var a=jQuery(".modal-handsontable");if(a.find(".modal-post-title").length||a.find(".modal-general-title").after('<h2 class="modal-post-title"></h2>'),a.find(".modal-post-title").html(t.modalSettings.post_title),t.modalSettings.modal_title&&a.find(".modal-general-title").html(t.modalSettings.modal_title),t.modalSettings.modal_description&&a.find(".modal-description").html(t.modalSettings.modal_description),t.modalSettings.modal_get_action){var o=jQuery(".remodal-bg").data("nonce");jQuery.get(ajaxurl,{action:t.modalSettings.modal_get_action,nonce:o,postId:t.modalSettings.post_id}).done(function(a){e(a.data,t.modalSettings)})}else e(t.existing,t.modalSettings)});function e(e,t){e||(e=[]);var a=t.handsontable_column_widths[t.post_type],o=t.handsontable_column_names[t.post_type],n=t.handsontable_columns[t.post_type],r=document.getElementById("handsontable-in-modal");window.hotAttr&&window.hotAttr.destroy();var s,i={data:s=e.custom_handsontable_args?e.data:e,minSpareRows:1,wordWrap:!0,colWidths:a,allowInsertRow:!0,columnSorting:!0,colHeaders:o,columns:n},d=jQuery.extend(i,e.custom_handsontable_args);window.hotAttr=new Handsontable(r,d),loading_ajax({estado:!1})}});
jQuery(document).ready(function(){if("undefined"==typeof hot)return!0;hot.updateSettings({afterLoadData:function(t){},cells:function(t,e,a){var n={};if("product"===jQuery("#post-data").data("post-type")||"status"===a){var r=hot.getDataAtCell(t,e);r&&"string"==typeof r&&r.indexOf("vg-cell-blocked")>-1&&(n.readOnly=!0,n.editor=!1,n.renderer="html",n.fillHandle=!1)}return n}})});